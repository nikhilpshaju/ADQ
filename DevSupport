def move_file_within_onelake(workspace_id, lakehouse_id, source_relative_path, dest_relative_path, access_token):
    """
    Moves a file from one folder to another within Fabric OneLake Files using the DFS REST API.
    Args:
        workspace_id (str): The Fabric workspace ID.
        lakehouse_id (str): The Lakehouse ID.
        source_relative_path (str): The current path (including filename) under Files.
        dest_relative_path (str): The destination path (including filename) under Files.
        access_token (str): Azure AD access token for https://onelake.dfs.fabric.microsoft.com/.default
    Returns:
        bool: True if move succeeded, False otherwise.
    """
    base_url = f"https://onelake.dfs.fabric.microsoft.com/{workspace_id}/{lakehouse_id}/Files"
    source_url = f"{base_url}/{source_relative_path}"
    dest_url = f"{base_url}/{dest_relative_path}"
    headers = {
        'Authorization': f'Bearer {access_token}',
        'x-ms-version': '2023-11-03',
        'x-ms-rename-source': f"/{workspace_id}/{lakehouse_id}/Files/{source_relative_path}",
        'x-ms-rename-mode': 'move'
    }
    response = requests.put(dest_url, headers=headers)
    if response.status_code in (200, 201):
        print(f"Moved file from '{source_relative_path}' to '{dest_relative_path}' successfully.")
        return True
    else:
        print(f"Failed to move file: {response.status_code} - {response.text}")
        return False












# Import the environment utility
import mssparkutils

# Retrieve the file name passed from the pipeline
file_name = mssparkutils.env.getEnvironmentVariable("file_name")

# Display the file name
print(f"Processing file: {file_name}")



Folder contents:
An error occurred while retrieving token from XML response: AADSTS53003: Access has been blocked by Conditional Access policies. The access policy does not allow token issuance.

pip install filelock==3.11.0
pip install PyJWT>=2.6.0
pip install fsspec==2023.6.0
------------------------
endpoint = "https://adq-aifoundrytest.cognitiveservices.azure.com/"
model_name = "gpt-4.1"
deployment = "gpt-4.1"

subscription_key = "<your-api-key>"
api_version = "2024-12-01-preview"

client = AzureOpenAI(
    api_version=api_version,
    azure_endpoint=endpoint,
    api_key=subscription_key,
)

response = client.chat.completions.create(
    messages=[
        {
            "role": "system",
            "content": "You are a helpful assistant.",
        },
        {
            "role": "user",
            "content": "I am going to Paris, what should I see?",
        }
    ],
    max_completion_tokens=13107,
    temperature=1.0,
    top_p=1.0,
    frequency_penalty=0.0,
    presence_penalty=0.0,
    model=deployment
)

print(response.choices[0].message.content)
----------------

https://github.com/enterprises/ey/sso

"C:\Users\npshaju\AppData\Local\Programs\Python\Python313\python.exe" "C:\Users\npshaju\AppData\Local\Programs\Python\Python313\Install Certificates.command"

python -m pip install --upgrade certifi

pip install requests


pip install Office365-REST-Python-Client
pip install msal
pip install requests
pip install PyJWT
pip install pandas


File "C:\Users\npshaju\AppData\Local\Programs\Python\Python313\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\npshaju\AppData\Local\Programs\Python\Python313\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\npshaju\AppData\Local\Programs\Python\Python313\Lib\site-packages\requests\adapters.py", line 675, in send
    raise SSLError(e, request=request)
requests.exceptions.SSLError: HTTPSConnectionPool(host='login.microsoftonline.com', port=443): Max retries exceeded with url: /d05f986a-a71d-4fff-87fe-ecf3bf8e4c5a/v2.0/.well-known/openid-configuration (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1032)')))


---
python ./Install\ Certificates.command
pip install --upgrade certifi
response = requests.get(url, headers=self.headers, verify=False)
-------
int.client_context import ClientContext
ModuleNotFoundError: No module named 'office365'
PS C:\Users\npshaju> py -m pip install requests
WARNING: Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:992)'))': /simple/requests/
WARNING: Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:992)'))': /simple/requests/
WARNING: Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:992)'))': /simple/requests/
WARNING: Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:992)'))': /simple/requests/
WARNING: Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:992)'))': /simple/requests/
Could not fetch URL https://pypi.org/simple/requests/: There was a problem confirming the ssl certificate: HTTPSConnectionPool(host='pypi.org', port=443): Max retries exceeded with url: /simple/requests/ (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:992)'))) - skipping
ERROR: Could not find a version that satisfies the requirement requests (from versions: none)
ERROR: No matching distribution found for requests
Could not fetch URL https://pypi.org/simple/pip/: There was a problem confirming the ssl certificate: HTTPSConnectionPool(host='pypi.org', port=443): Max retries exceeded with url: /simple/pip/ (Caused by SSLError(SSLCertVerificationError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:992)'))) - skipping
WARNING: There was an error checking the latest version of pip.
