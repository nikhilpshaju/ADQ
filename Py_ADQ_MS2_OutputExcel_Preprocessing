from openpyxl import load_workbook, Workbook
input_file = "input.xlsx"
output_file = "output.xlsx"

required_sheets = ["SoFP", "SoPL"]  

wb_in = load_workbook(input_file, data_only=True)

# Create a new workbook for output
wb_out = Workbook()
ws_out = wb_out.active
ws_out.title = "CombinedData"

# Write header in output sheet
headers = ["FSLI", "CurrentPeriod", "PriorPeriod", "SheetName"]
ws_out.append(headers)

# Iterate through only the required sheets
for sheet_name in required_sheets:
    if sheet_name not in wb_in.sheetnames:  # skip if sheet not present
        print(f"Warning: Sheet '{sheet_name}' not found in the input file.")
        continue   
    ws_in = wb_in[sheet_name]
   
    for row in ws_in.iter_rows(min_row=9, min_col=2, max_col=4, values_only=True):
        if all(v is None for v in row):  
            continue
        fsli, current, prior = row  
        ws_out.append([fsli, current, prior, sheet_name])

wb_out.save(output_file)

print(f"Data extracted to {output_file}")
